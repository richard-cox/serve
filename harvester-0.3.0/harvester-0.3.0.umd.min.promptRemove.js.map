{"version":3,"sources":["webpack://harvester-0.3.0/./promptRemove/kubevirt.io.virtualmachine.vue?3408","webpack://harvester-0.3.0/promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-0.3.0/./promptRemove/kubevirt.io.virtualmachine.vue?39d1","webpack://harvester-0.3.0/./promptRemove/kubevirt.io.virtualmachine.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","t","type","domProps","resourceNames","value","length","_l","removeNameArr","id","name","key","directives","rawName","expression","attrs","Array","isArray","checkedList","_i","on","$event","$$a","$$el","target","$$c","checked","$$v","$$i","concat","slice","checkAll","staticRenderFns","props","default","names","required","data","computed","forEach","crd","volume","persistentVolumeClaim","out","plusMore","reduce","i","res","watch","handler","unshift","keys","deep","immediate","methods","remove","parentComponent","doneLocation","goTo","Promise","all","map","resource","removedDisks","replace","currentRouter","push","close","error","err","component"],"mappings":"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","file":"harvester-0.3.0.umd.min.promptRemove.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('promptRemove.attemptingToRemove', {type: _vm.type}))+\" \"),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.resourceNames)}}),_c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.title'))+\" \")]),(_vm.value.length === 1)?_c('div',_vm._l((_vm.removeNameArr[_vm.value[0].id]),function(name){return _c('span',{key:name},[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkedList),expression:\"checkedList\"}],attrs:{\"type\":\"checkbox\",\"label\":name},domProps:{\"value\":name,\"checked\":Array.isArray(_vm.checkedList)?_vm._i(_vm.checkedList,name)>-1:(_vm.checkedList)},on:{\"change\":function($event){var $$a=_vm.checkedList,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=name,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkedList=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkedList=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkedList=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(name)+\" \")])])}),0):_c('div',[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkAll),expression:\"checkAll\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.checkAll)?_vm._i(_vm.checkAll,null)>-1:(_vm.checkAll)},on:{\"change\":function($event){var $$a=_vm.checkAll,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkAll=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkAll=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkAll=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.deleteAll'))+\" \")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { HCI } from '@shell/config/types';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:     Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    }\n  },\n\n  data() {\n    return {\n      checkedList: [],\n      checkAll:    true\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter(volume => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n\n    resourceNames() {\n      return this.names.reduce((res, name, i) => {\n        if (i >= 5) {\n          return res;\n        }\n        res += `<b>${ name }</b>`;\n        if (i === this.names.length - 1) {\n          res += this.plusMore;\n        } else {\n          res += i === this.toRemove.length - 2 ? ' and ' : ', ';\n        }\n\n        return res;\n      }, '');\n    }\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    remove() {\n      const parentComponent = this.$parent.$parent.$parent;\n\n      let goTo;\n\n      if (parentComponent.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...parentComponent.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          parentComponent.currentRouter.push(goTo);\n        }\n        parentComponent.close();\n      }).catch((err) => {\n        parentComponent.error = err;\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    {{ t('promptRemove.attemptingToRemove', {type}) }}\n    <span v-html=\"resourceNames\"></span>\n\n    <div class=\"mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.title') }}\n    </div>\n    <div v-if=\"value.length === 1\">\n      <span v-for=\"name in removeNameArr[value[0].id]\" :key=\"name\">\n        <label class=\"checkbox-container mr-15\"><input v-model=\"checkedList\" type=\"checkbox\" :label=\"name\" :value=\"name\" />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ name }}\n        </label>\n      </span>\n    </div>\n\n    <div v-else>\n      <label class=\"checkbox-container mr-15\"><input v-model=\"checkAll\" type=\"checkbox\" />\n        <span\n          class=\"checkbox-custom mr-5\"\n          role=\"checkbox\"\n        />\n        {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n      </label>\n    </div>\n  </div>\n</template>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=99d88b6a&\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}