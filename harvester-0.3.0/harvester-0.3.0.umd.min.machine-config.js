(("undefined"!==typeof self?self:this)["webpackJsonpharvester_0_3_0"]=("undefined"!==typeof self?self:this)["webpackJsonpharvester_0_3_0"]||[]).push([[9],{2007:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LabeledInput",e._b({ref:"value",attrs:{value:e.displayValue,type:"number",min:e.min,mode:e.mode,label:e.label,delay:e.delay,"label-key":e.labelKey,tooltip:e.tooltip,"tooltip-key":e.tooltipKey,required:e.required,placeholder:e.placeholder,"hide-arrows":e.hideArrows},on:{blur:function(t){return e.update(t.target.value)}},scopedSlots:e._u([{key:"suffix",fn:function(){return[e.displayUnit?a("div",{staticClass:"addon",class:{"with-tooltip":e.tooltip||e.tooltipKey}},[e._v(" "+e._s(e.displayUnit)+" ")]):e._e()]},proxy:!0}])},"LabeledInput",e.$attrs,!1))},s=[],i=a("67ab"),n=a("d444"),l=a("d6a6"),o={components:{LabeledInput:n["a"]},props:{outputAs:{type:String,default:"number"},outputModifier:{type:Boolean,default:!1},inputExponent:{type:Number,default:0},baseUnit:{type:String,default:"B"},hideArrows:{type:Boolean,default:!1},increment:{type:Number,default:1e3},suffix:{type:String,default:null},mode:{type:String,default:l["i"]},value:{type:[Number,String],default:null},label:{type:String,default:null},labelKey:{type:String,default:null},tooltip:{type:[String,Object],default:null},tooltipKey:{type:String,default:null},required:{type:Boolean,default:!1},min:{type:[Number,String],default:0},placeholder:{type:[String,Number],default:""},delay:{type:Number,default:0}},computed:{unit:function(){var e;return e=this.inputExponent>=0?i["b"][this.inputExponent]:i["a"][-1*this.inputExponent],1024===this.increment&&e&&(e+="i"),e},parsedValue:function(){return"string"===typeof this.value?Object(i["f"])(this.value):this.value},displayValue:function(){var e="";return(this.parsedValue||0===this.parsedValue)&&(e=Object(i["e"])(this.parsedValue,{increment:this.increment,addSuffix:!1,maxExponent:this.inputExponent,minExponent:this.inputExponent})),e},displayUnit:function(){return this.suffix?this.suffix:this.unit+this.baseUnit}},methods:{focus:function(){var e=this.$refs.value;e&&e.focus()},update:function(e){var t=""===e?null:e;this.outputModifier?t=null===t?null:"".concat(e).concat(this.unit):"string"===this.outputAs?t=null===t?"":"".concat(e):t&&(t=this.unit?Object(i["f"])("".concat(t).concat(this.unit)):parseInt(t)),this.$emit("input",t)}}},c=o,d=(a("f4f2"),a("d802")),u=Object(d["a"])(c,r,s,!1,null,"aff9cfe4",null);t["a"]=u.exports},2465:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.$fetchState.pending?a("Loading",{attrs:{delayed:!0}}):a("div",[a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("UnitInput",{directives:[{name:"int-number",rawName:"v-int-number"}],attrs:{"label-key":"cluster.credential.harvester.cpu",suffix:"C","output-as":"string",required:"",mode:e.mode,disabled:e.disabled,placeholder:e.t("cluster.harvester.machinePool.cpu.placeholder")},model:{value:e.value.cpuCount,callback:function(t){e.$set(e.value,"cpuCount",t)},expression:"value.cpuCount"}})],1),a("div",{staticClass:"col span-6"},[a("UnitInput",{directives:[{name:"int-number",rawName:"v-int-number"}],attrs:{"label-key":"cluster.credential.harvester.memory","output-as":"string",suffix:"GiB",mode:e.mode,disabled:e.disabled,required:"",placeholder:e.t("cluster.harvester.machinePool.memory.placeholder")},model:{value:e.value.memorySize,callback:function(t){e.$set(e.value,"memorySize",t)},expression:"value.memorySize"}})],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("UnitInput",{directives:[{name:"int-number",rawName:"v-int-number"}],attrs:{"label-key":"cluster.credential.harvester.disk","output-as":"string",suffix:"GiB",mode:e.mode,disabled:e.disabled,required:"",placeholder:e.t("cluster.harvester.machinePool.disk.placeholder")},model:{value:e.value.diskSize,callback:function(t){e.$set(e.value,"diskSize",t)},expression:"value.diskSize"}})],1),a("div",{staticClass:"col span-6"},[e.isImportCluster?a("LabeledSelect",{attrs:{mode:e.mode,options:e.namespaceOptions,searchable:!0,required:!0,disabled:e.namespaceDisabled,"label-key":"cluster.credential.harvester.namespace",placeholder:e.t("cluster.harvester.machinePool.namespace.placeholder")},model:{value:e.value.vmNamespace,callback:function(t){e.$set(e.value,"vmNamespace",t)},expression:"value.vmNamespace"}}):a("LabeledInput",{attrs:{"label-key":"cluster.credential.harvester.namespace",required:!0,mode:e.mode,disabled:e.namespaceDisabled,placeholder:e.t("cluster.harvester.machinePool.namespace.placeholder")},model:{value:e.value.vmNamespace,callback:function(t){e.$set(e.value,"vmNamespace",t)},expression:"value.vmNamespace"}})],1)]),e.isImportCluster?a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("LabeledSelect",{attrs:{mode:e.mode,options:e.imageOptions,required:!0,disabled:e.disabledEdit,"label-key":"cluster.credential.harvester.image",placeholder:e.t("cluster.harvester.machinePool.image.placeholder")},on:{"on-open":e.onOpen},model:{value:e.value.imageName,callback:function(t){e.$set(e.value,"imageName",t)},expression:"value.imageName"}})],1),a("div",{staticClass:"col span-6"},[a("LabeledSelect",{attrs:{mode:e.mode,options:e.networkOptions,required:!0,disabled:e.disabledEdit,"label-key":"cluster.credential.harvester.network",placeholder:e.t("cluster.harvester.machinePool.network.placeholder")},model:{value:e.value.networkName,callback:function(t){e.$set(e.value,"networkName",t)},expression:"value.networkName"}})],1)]):a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,required:!0,placeholder:e.t("cluster.credential.harvester.placeholder"),disabled:e.disabledEdit,"label-key":"cluster.credential.harvester.image"},model:{value:e.value.imageName,callback:function(t){e.$set(e.value,"imageName",t)},expression:"value.imageName"}})],1),a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,required:!0,placeholder:e.t("cluster.credential.harvester.placeholder"),disabled:e.disabledEdit,"label-key":"cluster.credential.harvester.network"},model:{value:e.value.networkName,callback:function(t){e.$set(e.value,"networkName",t)},expression:"value.networkName"}})],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{"label-key":"cluster.credential.harvester.sshUser",required:!0,mode:e.mode,disabled:e.disabled,placeholder:e.t("cluster.harvester.machinePool.sshUser.placeholder"),"tooltip-key":"cluster.harvester.machinePool.sshUser.toolTip"},model:{value:e.value.sshUser,callback:function(t){e.$set(e.value,"sshUser",t)},expression:"value.sshUser"}})],1)]),a("portal",{attrs:{to:"advanced-"+e.uuid}},[a("h3",[e._v(e._s(e.t("cluster.credential.harvester.userData.title")))]),a("div",[e.isImportCluster&&e.isCreate?a("LabeledSelect",{staticClass:"mb-10",attrs:{options:e.userDataOptions,"label-key":"cluster.credential.harvester.userData.label",mode:e.mode,disabled:e.disabled},model:{value:e.userData,callback:function(t){e.userData=t},expression:"userData"}}):e._e(),a("YamlEditor",{key:e.userData,ref:"userDataYamlEditor",staticClass:"yaml-editor mb-20",attrs:{"editor-mode":"view"===e.mode?"VIEW_CODE":"EDIT_CODE",value:e.userData,disabled:e.disabled},on:{onInput:function(t){return e.valuesChanged(t,"userData")}}})],1),a("h3",[e._v(e._s(e.t("cluster.credential.harvester.networkData.title")))]),a("div",[e.isImportCluster&&e.isCreate?a("LabeledSelect",{staticClass:"mb-10",attrs:{options:e.networkDataOptions,"label-key":"cluster.credential.harvester.networkData.label",mode:e.mode,disabled:e.disabled},model:{value:e.networkData,callback:function(t){e.networkData=t},expression:"networkData"}}):e._e(),a("YamlEditor",{key:e.networkData,ref:"networkYamlEditor",staticClass:"yaml-editor mb-10",attrs:{"editor-mode":"view"===e.mode?"VIEW_CODE":"EDIT_CODE",value:e.networkData,disabled:e.disabled},on:{onInput:function(t){return e.valuesChanged(t,"networkData")}}})],1)])],1),e.errors.length?a("div",e._l(e.errors,(function(t,r){return a("div",{key:r},[a("Banner",{attrs:{color:"error",label:e.stringify(t.Message||t)}})],1)})),0):e._e()],1)},s=[],i=a("56d4"),n=a.n(i),l=a("330a"),o=a.n(l),c=a("70a6"),d=a("c78c"),u=a("53fe"),p=a("d444"),v=a("2007"),f=a("c349"),m=a("dffb"),h=a("1832"),b=a("9ce4"),y=a("56a4"),k=a("8672"),w=a("b837"),g=a("3792"),x=a("b0bd"),O=a("80dd");function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){I(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function E(e,t,a,r,s,i,n){try{var l=e[i](n),o=l.value}catch(g){return void a(g)}l.done?t(o):Promise.resolve(o).then(r,s)}function N(e){return function(){var t=this,a=arguments;return new Promise((function(r,s){var i=e.apply(t,a);function n(e){E(i,r,s,n,l,"next",e)}function l(e){E(i,r,s,n,l,"throw",e)}n(void 0)}))}}var S={name:"ConfigComponentHarvester",components:{Loading:c["a"],LabeledSelect:u["a"],LabeledInput:p["a"],UnitInput:v["a"],Banner:m["a"],YamlEditor:f["b"]},mixins:[d["a"]],props:{credentialId:{type:String,required:!0},uuid:{type:String,required:!0},disabled:{type:Boolean,default:!1},poolIndex:{type:Number,required:!0},machinePools:{type:Array,default:function(){return[]}}},fetch:function(){var e=this;return N(n.a.mark((function t(){var a,r,s,i,l,c,d,u,p,v,f,m,b,k,O;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.errors=[],t.prev=1,t.next=4,e.$store.dispatch("rancher/find",{type:y["u"].CLOUD_CREDENTIAL,id:e.credentialId});case 4:if(e.credential=t.sent,a=Object(h["g"])(e.credential,"decodedData.clusterId"),r="/k8s/clusters/".concat(a,"/v1"),s="imported"===e.credential.decodedData.clusterType,e.isImportCluster=s,!a||!s){t.next=36;break}return t.next=12,Object(w["b"])({namespaces:e.$store.dispatch("cluster/request",{url:"".concat(r,"/").concat(y["q"],"s")}),images:e.$store.dispatch("cluster/request",{url:"".concat(r,"/").concat(y["h"].IMAGE,"s")}),configMaps:e.$store.dispatch("cluster/request",{url:"".concat(r,"/").concat(y["c"],"s")}),networks:e.$store.dispatch("cluster/request",{url:"".concat(r,"/k8s.cni.cncf.io.network-attachment-definitions")})});case 12:u=t.sent,p=0,v=Object.keys(u);case 14:if(!(p<v.length)){t.next=23;break}if(f=v[p],m=u[f],"rejected"!==m.status){t.next=20;break}return e.errors.push(Object(g["b"])(m.reason)),t.abrupt("continue",20);case 20:p++,t.next=14;break;case 23:if(!(e.errors.length>0)){t.next=28;break}return t.next=26,e.$store.dispatch("management/find",{type:y["n"].CLUSTER,id:a});case 26:b=t.sent,b.stateDescription&&!b.isReady&&(e.errors=[b.stateDescription]);case 28:k=[],O=[],((null===(i=u.configMaps.value)||void 0===i?void 0:i.data)||[]).map((function(e){var t,a,r=null===(t=e.metadata)||void 0===t||null===(a=t.labels)||void 0===a?void 0:a[x["f"].CLOUD_INIT];"user"===r&&k.push({label:e.metadata.name,value:e.data.cloudInit}),"network"===r&&O.push({label:e.metadata.name,value:e.data.cloudInit})})),e.userDataOptions=k,e.networkDataOptions=O,e.images=null===(l=u.images.value)||void 0===l?void 0:l.data,e.networkOptions=((null===(c=u.networks.value)||void 0===c?void 0:c.data)||[]).map((function(e){var t,a;try{var r=JSON.parse(e.spec.config),s=r.vlan;t=e.id,a="".concat(t," (vlanId=").concat(s,")")}catch(i){}return{label:a,value:t}})),((null===(d=u.namespaces.value)||void 0===d?void 0:d.data)||[]).forEach(function(){var t=N(n.a.mark((function t(a){var r,s,i;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("cluster/create",a);case 2:r=t.sent,r.isSystem||(s=a.metadata.name,i=a.metadata.name,e.namespaceOptions.push({label:i,value:s}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 36:o()(e.value.cpuCount)&&(e.value.cpuCount="2"),o()(e.value.memorySize)&&(e.value.memorySize="4"),o()(e.value.diskSize)&&(e.value.diskSize="40"),t.next=44;break;case 41:t.prev=41,t.t0=t["catch"](1),e.errors=Object(g["a"])(t.t0);case 44:case"end":return t.stop()}}),t,null,[[1,41]])})))()},data:function(){var e="",t="";return this.value.userData&&(e=Object(k["a"])(this.value.userData)),this.value.networkData&&(t=Object(k["a"])(this.value.networkData)),{credential:null,isImportCluster:!1,userData:e,networkData:t,images:[],namespaceOptions:[],networkOptions:[],userDataOptions:[],networkDataOptions:[],cpuCount:""}},computed:C(C({},Object(b["a"])({t:"i18n/t"})),{},{disabledEdit:function(){return this.disabled||!(!this.isEdit||!this.value.id)},imageOptions:function(){return(this.images||[]).filter((function(e){return!e.spec.url.endsWith(".iso")&&O["isReady"].call(e)})).map((function(e){var t=e.id,a="".concat(e.spec.displayName," (").concat(t,")");return{label:a,value:t}}))},namespaceDisabled:function(){return this.disabledEdit||this.poolIndex>0}}),watch:{credentialId:function(){this.isEdit||(this.imageOptions=[],this.networkOptions=[],this.namespaceOptions=[],this.value.imageName="",this.value.networkName="",this.value.vmNamespace=""),this.$fetch()},networkData:function(e){this.$refs.networkYamlEditor.refresh(),this.value.networkData=Object(k["b"])(e)},userData:function(e){this.$refs.userDataYamlEditor.refresh(),this.value.userData=Object(k["b"])(e)},machinePools:{handler:function(e){var t=e[0].config.vmNamespace;this.poolIndex>0&&this.value.vmNamespace!==t&&(this.value.vmNamespace=t)},deep:!0}},methods:{stringify:g["b"],test:function(){var e=[];if(!this.value.cpuCount){var t=this.validatorRequiredField(this.t("cluster.credential.harvester.cpu"));e.push(t)}if(!this.value.vmNamespace){var a=this.validatorRequiredField(this.t("cluster.credential.harvester.namespace"));e.push(a)}if(!this.value.memorySize){var r=this.validatorRequiredField(this.t("cluster.credential.harvester.memory"));e.push(r)}if(!this.value.diskSize){var s=this.validatorRequiredField(this.t("cluster.credential.harvester.disk"));e.push(s)}if(!this.value.imageName){var i=this.validatorRequiredField(this.t("cluster.credential.harvester.image"));e.push(i)}if(!this.value.sshUser){var n=this.validatorRequiredField(this.t("cluster.credential.harvester.sshUser"));e.push(n)}if(!this.value.networkName){var l=this.validatorRequiredField(this.t("cluster.credential.harvester.network"));e.push(l)}return{errors:e}},validatorRequiredField:function(e){return this.t("validation.required",{key:e})},valuesChanged:function(e,t){this.value[t]=Object(k["b"])(e)},onOpen:function(){this.getVmImage()},getVmImage:function(){var e=this;return N(n.a.mark((function t(){var a,r,s;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=Object(h["g"])(e.credential,"decodedData.clusterId"),r="/k8s/clusters/".concat(a,"/v1"),!r||!e.isImportCluster){t.next=8;break}return t.next=6,e.$store.dispatch("cluster/request",{url:"".concat(r,"/").concat(y["h"].IMAGE,"s")});case 6:s=t.sent,e.images=null===s||void 0===s?void 0:s.data;case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.errors=Object(g["a"])(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},_=S,j=(a("c9e4"),a("d802")),q=Object(j["a"])(_,r,s,!1,null,"3b9fbcae",null);t["default"]=q.exports},"45aa":function(e,t,a){var r=a("7142");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("a9e57d1e",r,!0,{sourceMap:!1,shadowMode:!1})},"6c20":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,'.clearfix[data-v-aff9cfe4]:after,.clearfix[data-v-aff9cfe4]:before{content:" ";display:table}.clearfix[data-v-aff9cfe4]:after{clear:both}.list-unstyled[data-v-aff9cfe4]{margin:0;padding:0;list-style-type:none}.no-select[data-v-aff9cfe4]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.no-resize[data-v-aff9cfe4]{resize:none}.hand[data-v-aff9cfe4]{cursor:pointer;cursor:hand}.fixed[data-v-aff9cfe4]{table-layout:fixed}.clip[data-v-aff9cfe4]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-aff9cfe4],.force-wrap[data-v-aff9cfe4]{word-wrap:break-word}.force-wrap[data-v-aff9cfe4]{white-space:normal}.bordered-section[data-v-aff9cfe4]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-aff9cfe4]{margin-bottom:20px;margin-top:20px}.addon.with-tooltip[data-v-aff9cfe4]{position:relative;right:30px}',""]),e.exports=t},7142:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,'.clearfix[data-v-3b9fbcae]:after,.clearfix[data-v-3b9fbcae]:before{content:" ";display:table}.clearfix[data-v-3b9fbcae]:after{clear:both}.list-unstyled[data-v-3b9fbcae]{margin:0;padding:0;list-style-type:none}.no-select[data-v-3b9fbcae]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.no-resize[data-v-3b9fbcae]{resize:none}.hand[data-v-3b9fbcae]{cursor:pointer;cursor:hand}.fixed[data-v-3b9fbcae]{table-layout:fixed}.clip[data-v-3b9fbcae]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-3b9fbcae],.force-wrap[data-v-3b9fbcae]{word-wrap:break-word}.force-wrap[data-v-3b9fbcae]{white-space:normal}.bordered-section[data-v-3b9fbcae]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-3b9fbcae]{margin-bottom:20px;margin-top:20px}[data-v-3b9fbcae] .yaml-editor{flex:1;min-height:200px}[data-v-3b9fbcae] .yaml-editor .code-mirror .CodeMirror{position:static;height:auto;min-height:200px}',""]),e.exports=t},c196:function(e,t,a){var r=a("6c20");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("7551af46",r,!0,{sourceMap:!1,shadowMode:!1})},c9e4:function(e,t,a){"use strict";a("45aa")},f4f2:function(e,t,a){"use strict";a("c196")}}]);
//# sourceMappingURL=harvester-0.3.0.umd.min.machine-config.js.map